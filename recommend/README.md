# 추천 시스템

- spring web server
- mysql
- redis

## 요구 사항

- 추천 받는건 유저당 최초 1회만 가능하다
- 추천을 통해서 가입하면 1만원을 지급하며, 가용 금액은 최대 30억이다.

## 서버 시작

- docker compose up -d
- mysql : 13306 포트
- web : 18080 포트
- redis : 16379 포트

## 테스트 시작

- node runner.js

## 테스트 결과

- 레디스로 락을 잡고 값을 읽고, 업데이트하고, 락을 풀어 레디스 동시성 처리
  - setnx 방식, spin lock 방식
- 유저 지속적으로 부하를 넣어도, 잘 가입되고, 공통 이벤트 금액 변수도 잘 차감되는 것 확인

## 더 고려해봐야 할 것

- 임계값 30억 부근에서 어떻게 동작해야할지 고민
- 만약 레디스가 엄청나게 밀려서 timeout이 뜨고, 다음 유저가 성공해버리면 어떻게 처리해야할지?
  - 큐로 순차적 처리를 보장해야할 수 도 있겠다..